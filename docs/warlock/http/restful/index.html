<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-warlock/http/restful" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Restful API | Warlock.js</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mentoor.io/logo.svg"><meta data-rh="true" name="twitter:image" content="https://mentoor.io/logo.svg"><meta data-rh="true" property="og:url" content="https://warlock.js.org/docs/warlock/http/restful"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Restful API | Warlock.js"><meta data-rh="true" name="description" content="Warlock embraces the RESTful API design, and provides a set of tools to help you build RESTful APIs."><meta data-rh="true" property="og:description" content="Warlock embraces the RESTful API design, and provides a set of tools to help you build RESTful APIs."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://warlock.js.org/docs/warlock/http/restful"><link data-rh="true" rel="alternate" href="https://warlock.js.org/docs/warlock/http/restful" hreflang="en"><link data-rh="true" rel="alternate" href="https://warlock.js.org/docs/warlock/http/restful" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f72f589a.css">
<script src="/assets/js/runtime~main.b156083d.js" defer="defer"></script>
<script src="/assets/js/main.e6d1dc1a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://mentoor.io/logo.svg" alt="mentoor.io" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://mentoor.io/logo.svg" alt="mentoor.io" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Warlock.js EcoSystem</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/warlock/getting-started/introduction">Warlock</a><a class="navbar__item navbar__link" href="/docs/cascade/getting-started/introduction">Cascade</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hassanzohdy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/database">Database</a><button aria-label="Expand sidebar category &#x27;Database&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/http-requests">Http Requests</a><button aria-label="Collapse sidebar category &#x27;Http Requests&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/routes">Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/configurations">Http configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/request">Request</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/uploaded-files">Uploaded Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/middleware">Middleware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/response">Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/request-context">Request Context</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/output">Output</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/warlock/http/restful">Restful API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/repositories">Repositories</a><button aria-label="Expand sidebar category &#x27;Repositories&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/validation">Validation</a><button aria-label="Expand sidebar category &#x27;Validation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/auth">Auth</a><button aria-label="Expand sidebar category &#x27;Auth&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/localization">Localization</a><button aria-label="Expand sidebar category &#x27;Localization&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/uploads">Uploads</a><button aria-label="Expand sidebar category &#x27;Uploads&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/cache">Cache</a><button aria-label="Expand sidebar category &#x27;Cache&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/image">Image</a><button aria-label="Expand sidebar category &#x27;Image&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/mail">Mail</a><button aria-label="Expand sidebar category &#x27;Mail&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/log">Log</a><button aria-label="Expand sidebar category &#x27;Log&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/utils">Utils</a><button aria-label="Expand sidebar category &#x27;Utils&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/production">Production</a><button aria-label="Expand sidebar category &#x27;Production&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/advanced">Advanced</a><button aria-label="Expand sidebar category &#x27;Advanced&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/http-requests"><span itemprop="name">Http Requests</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Restful API</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1 id="restful-api">Restful API</h1>
<p>Warlock embraces the RESTful API design, and provides a set of tools to help you build RESTful APIs.</p>
<p>One of them is the <code>Restful</code> class.</p>
<h2 id="restful-class">Restful class</h2>
<p>The <code>Restful</code> class is a base class for RESTful API controllers. It provides a set of methods to help you build RESTful APIs.</p>
<h2 id="declaring-a-restful-controller">Declaring a Restful controller</h2>
<p>You can use <a href="https://marketplace.visualstudio.com/items?itemName=hassanzohdy.gnz">Generator Z</a> to generate a Restful controller by right click on the <code>controllers</code> directory then <code>Generate Warlock Module</code> then <code>Generate Warlock Restful Request</code>.</p>
<p>Or you can create it manually, which we will do now.</p>
<p>First off, restful controllers heavily depends on <a href="./../repositories/introduction">Repositories</a>, so get to know it before continuing this section.</p>
<p>Now let&#x27;s create our <code>restfulUsers</code> controller</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">import { Restful } from &#x27;@warlock.js/core&#x27;;
import { User } from &quot;app/users/models/user&quot;:
import userRepository from &quot;app/users/repositories/users-repository&quot;;

class RestfulUsers&lt;User&gt; extends Restful {
  /**
   * {@inheritDoc}
   */
  protected repository = usersRepository;
}

const restfulUsers = new RestfulUsers();

export default restfulUsers;
</code></pre>
<p>Let&#x27;s break down this code:</p>
<ul>
<li>We imported the <code>Restful</code> class from <code>@warlock.js/core</code> package.</li>
<li>We imported the <code>User</code> model from <code>app/users/models/user</code>, which will be used for typescript type checking.</li>
<li>We imported the <code>usersRepository</code> from <code>app/users/repositories/users-repository</code>, which will be used to operate on the database.</li>
<li>We extended the <code>Restful</code> class, and set the <code>repository</code> property to <code>usersRepository</code>.</li>
<li>We created an instance of the <code>RestfulUsers</code> class.</li>
<li>We exported the <code>restfulUsers</code> instance.</li>
</ul>
<p>Now our controller is ready to use.</p>
<h2 id="restful-methods">Restful methods</h2>
<p>By default a Restful controller has the following methods:</p>
<ul>
<li><code>list</code>: To list records.</li>
<li><code>create</code>: To create a new record.</li>
<li><code>update</code>: To update an existing record.</li>
<li><code>delete</code>: To delete an existing record.</li>
<li><code>bulkDelete</code>: To delete multiple records.</li>
<li><code>patch</code>: To update an existing record partially.</li>
</ul>
<p>Now let&#x27;s see how to define our restful and its corresponding methods.</p>
<h2 id="defining-restful-routes">Defining restful routes</h2>
<p>Warlock&#x27;s router system has a builtin <code>restfulResource</code> method that accepts the base path of the resource, and the controller instance.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/routes.ts&quot;">import { router } from &quot;@warlock.js/core&quot;;
import restfulUsers from &quot;app/users/controllers/restful-users&quot;;

router.restfulResource(&quot;users&quot;, restfulUsers);
</code></pre>
<p>This will create routes for the previous methods as follows:</p>
<table><thead><tr><th>Request Method</th><th>Path</th><th>Restful Method</th><th>Description</th></tr></thead><tbody><tr><td>GET</td><td><strong>/users</strong></td><td><code>restful.list</code></td><td>List users</td></tr><tr><td>POST</td><td><strong>/users</strong></td><td><code>restful.create</code></td><td>Create a new user</td></tr><tr><td>GET</td><td><strong>/users/<!-- -->:id</strong></td><td><code>restful.get</code></td><td>Get a user</td></tr><tr><td>PUT</td><td><strong>/users/<!-- -->:id</strong></td><td><code>restful.update</code></td><td>Update a user</td></tr><tr><td>PATCH</td><td><strong>/users/<!-- -->:id</strong></td><td><code>restful.patch</code></td><td>Partially update a user</td></tr><tr><td>DELETE</td><td><strong>/users/<!-- -->:id</strong></td><td><code>restful.delete</code></td><td>Delete a user</td></tr><tr><td>DELETE</td><td><strong>/users</strong></td><td><code>restful.bulkDelete</code></td><td>Delete multiple users</td></tr></tbody></table>
<h2 id="list-method">List Method</h2>
<p>The <code>list</code> method is used to list records, it sends all request inputs to the repository&#x27;s <code>list</code> method.</p>
<blockquote>
<p>If <a href="./../cache/introduction">Cache</a> is enabled then <code>repository.listCached</code> method will be used instead of <code>repository.list</code>.</p>
</blockquote>
<p>By default when calling <code>/users</code> the response will be returned with pagination (Because list method has default pagination option to <strong>true</strong>) so there will be two keys that will be sent to the response:</p>
<blockquote>
<p>The sent inputs from the request to the repository list methods will be used against <a href="./request#get-heavy-inputs">Request Heavy method</a>.</p>
</blockquote>
<ul>
<li><code>records</code>: list of records that are fetched from the database.</li>
<li><a href="./../../cascade/aggregate/fetching#pagination">paginationInfo</a>: The pagination info that is returned from the repository.</li>
</ul>
<p>Records that are sent are instance of the repository&#x27;s model, so in our case users, it will be list of <code>User</code> models.</p>
<h3 id="change-default-records-key">Change default records key</h3>
<p>To send another key instead of <code>records</code>, define <code>recordsListName</code> property in the controller.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">import { Restful } from &#x27;@warlock.js/core&#x27;;
import { User } from &quot;app/users/models/user&quot;:
import userRepository from &quot;app/users/repositories/users-repository&quot;;

class RestfulUsers&lt;User&gt; extends Restful {
  /**
   * {@inheritDoc}
   */
  protected repository = usersRepository;

  /**
   * {@inheritDoc}
   */
  protected recordsListName = &#x27;users&#x27;;
}

const restfulUsers = new RestfulUsers();

export default restfulUsers;
</code></pre>
<p>This will return an object contains <code>users</code> and <code>paginationInfo</code> keys.</p>
<h3 id="list-middleware">List middleware</h3>
<p>To define a middleware to be executed before calling the <code>restful.list</code> method, define <code>middleware</code> property in the restful users controller.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">
import {Request, Response, Restful } from &#x27;@warlock.js/core&#x27;;
import { User } from &quot;app/users/models/user&quot;:
import userRepository from &quot;app/users/repositories/users-repository&quot;;

class RestfulUsers&lt;User&gt; extends Restful {
  /**
   * {@inheritDoc}
   */
  protected repository = usersRepository;

  /**
   * {@inheritDoc}
   */
  protected recordsListName = &#x27;users&#x27;;
  /**
   * Middleware
   */
  protected middleware = {
    list: [
      // middleware
      this.isSuperAdmin.bind(this),
    ],
  };

  protected isSuperAdmin(request: Request, response: Response) {
    // check if the user is super admin
    if (request.user.isSuperAdmin === false) {
      return response.forbidden();
    }
  }
}

const restfulUsers = new RestfulUsers();

export default restfulUsers;
</code></pre>
<p>This way we can interrupt the request and return a response before calling the <code>restful.list</code> method.</p>
<h2 id="get-method">Get Method</h2>
<p>To fetch a single user, a GET request to <code>/users/:id</code> is sent, and the <code>restful.get</code> method is called.</p>
<p>The <code>restful.get</code> method sends the <code>id</code> to the repository&#x27;s <code>find</code> method.</p>
<p>If the record is not found, a <code>404</code> response is returned.</p>
<blockquote>
<p>If <a href="./../cache/introduction">Cache</a> is enabled then <code>repository.findCached</code> method will be used instead of <code>repository.find</code>.</p>
</blockquote>
<h3 id="get-middleware">Get middleware</h3>
<p>Same as the <code>list</code> method, you can define a middleware to be executed before calling the <code>restful.get</code> method.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
class RestfulUsers&lt;User&gt; extends Restful {
  //...
  /**
   * Middleware
   */
  protected middleware = {
    get: [
      // middleware
      this.isSuperAdmin.bind(this),
    ],
  };
  //...
}
//...
</code></pre>
<h3 id="get-response-key">Get response key</h3>
<p>If the record is found, it will be returned in <code>record</code> key, to change the response key define <code>recordName</code> property in the controller.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
class RestfulUsers&lt;User&gt; extends Restful {
  //...
  /**
   * {@inheritDoc}
   */
  protected recordName = &quot;user&quot;;
  //...
}
//...
</code></pre>
<p>This will return an object contains <code>user</code> key.</p>
<h2 id="create-method">Create Method</h2>
<p>To create a new user, a POST request to <code>/users</code> is sent, and the <code>restful.create</code> method is called.</p>
<p>The <code>restful.create</code> method sends all request inputs to the repository&#x27;s <code>create</code> method.</p>
<p>If the record is created successfully, a <code>201</code> response is returned with the created record.</p>
<h3 id="create-validation">Create Validation</h3>
<p>So the validation here is a little different than normal function handler, but to the better, in our restful class, there will be <code>validation</code> property defined automatically (if generated using the generator), and it will look like:</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
import { RouteResource } from &quot;@warlock.js/core&quot;;

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    create: {
      rules: {
        firstName: [&quot;required&quot;, &quot;min:2&quot;],
        lastName: [&quot;required&quot;, &quot;min:2&quot;],
      },
    },
  };
  //...
}
//...
</code></pre>
<p>This is way we defined a validation for the <code>create</code> method, and it will be executed before calling the <code>restful.create</code> method.</p>
<p>We can use another rules like <code>UniqueRule</code> as follows:</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
import { UniqueRule, RouteResource } from &quot;@warlock.js/core&quot;;

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    create: {
      rules: {
        firstName: [&quot;required&quot;, &quot;min:2&quot;],
        lastName: [&quot;required&quot;, &quot;min:2&quot;],
        email: [&quot;required&quot;, &quot;email&quot;, new UniqueRule(User)],
      },
    },
  };
  //...
}
</code></pre>
<p>Of course we can define a custom validation method by passing to the <code>middleware.create</code> object a <code>validate</code> callback.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
import { RouteResource } from &quot;@warlock.js/core&quot;;

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    create: {
      validate: this.validate.bind(this),
    },
  };

  protected validate(request: Request, response: Response) {
    // validate the request
  }
  //...
}
</code></pre>
<h3 id="create-events">Create Events</h3>
<p>Restful class by default triggers multiple events, and they are as follows:</p>
<ul>
<li><code>beforeCreate(request: Request)</code>: Triggered before creating the record.</li>
<li><code>beforeSave(request: Request)</code>: Triggered before creating or update the record.</li>
<li><code>onCreate(request: Request, record: Model)</code>: Triggered after creating the record.</li>
<li><code>onSave(request: Request, record: Model)</code>: Triggered after creating or updating the record.</li>
</ul>
<blockquote>
<p>Please note that any <code>xSave</code> event is triggered in three case: create, update, and patch.</p>
</blockquote>
<p>An example of usage for <code>onSave</code> event will be as follows:</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    create: {
      rules: {
        firstName: [&quot;required&quot;, &quot;min:2&quot;],
        lastName: [&quot;required&quot;, &quot;min:2&quot;],
      },
    },
  };

  /**
   * {@inheritDoc}
   */
  public onSave(request: Request, record: Model) {
    // update the current user if it is the same user that was updated
    if (request.user.id === record.id) {
      request.user = record;
    }
  }
  //...
}
</code></pre>
<h3 id="return-type">Return Type</h3>
<p>When creating a new record, you can return two types of responses:</p>
<ul>
<li><code>Single Record</code>: The newly created record, <strong>this is the default behavior</strong>.</li>
<li><code>List</code>: which calls the <code>list</code> method and returns the list of records.</li>
</ul>
<p>To change the default behavior, define a <code>returnOn</code> property with <code>create</code> key in the controller.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
class RestfulUsers&lt;User&gt; extends Restful {
  //...
  /**
   * {@inheritDoc}
   */
  protected returnOn = {
    create: &quot;record&quot;, // record | records
  };
  //...
}
</code></pre>
<h2 id="update-method">Update Method</h2>
<p>Pretty much the same as the <code>create</code> method, but it calls the <code>restful.update</code> method.</p>
<h3 id="update-validation">Update Validation</h3>
<p>Instead of defining a validation for the <code>create</code> method, we define it for the <code>update</code> method.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    update: {
      rules: {
        firstName: [&quot;required&quot;, &quot;min:2&quot;],
        lastName: [&quot;required&quot;, &quot;min:2&quot;],
      },
    },
  };
  //...
}
</code></pre>
<p>We can also use the <code>UniqueRule</code> as well:</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
import { UniqueRule, RouteResource } from &quot;@warlock.js/core&quot;;

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    update: {
      rules: {
        firstName: [&quot;required&quot;, &quot;min:2&quot;],
        lastName: [&quot;required&quot;, &quot;min:2&quot;],
        email: [&quot;required&quot;, &quot;email&quot;, new UniqueRule(User).exceptCurrentUser()],
      },
    },
  };
  //...
}
</code></pre>
<p>Using <code>exceptCurrentUser</code> will validate the rule against all records except the current record.</p>
<h3 id="update-events">Update Events</h3>
<p>Same as the <code>create</code> method, but with different names:</p>
<ul>
<li><code>beforeUpdate(request: Request, model: Model)</code>: Triggered before updating the record.</li>
<li><code>beforeSave(request: Request, model: Model)</code>: Triggered before creating or update the record.</li>
<li><code>onUpdate(request: Request, model: Model, oldModel: Model)</code>: Triggered after updating the record.</li>
<li><code>onSave(request: Request, model: Model, oldModel: Model)</code>: Triggered after creating or updating the record.</li>
</ul>
<p>When updating model, the old data of the model will be sent to events <code>onUpdate</code> and <code>onSave</code> methods.</p>
<h3 id="return-type-1">Return Type</h3>
<p>When updating an existing record, you can return two types of responses:</p>
<ul>
<li><code>Single Record</code>: The updated record, <strong>this is the default behavior</strong>.</li>
<li><code>List</code>: which calls the <code>list</code> method and returns the list of records.</li>
</ul>
<p>To change the default behavior, define a <code>returnOn</code> property with <code>update</code> key in the controller.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...
class RestfulUsers&lt;User&gt; extends Restful {
  //...
  /**
   * {@inheritDoc}
   */
  protected returnOn = {
    update: &quot;record&quot;, // record | records
  };
  //...
}
</code></pre>
<h2 id="patch-method">Patch Method</h2>
<p>The <code>patch</code> method is used to update a record partially, it calls the <code>restful.patch</code> method.</p>
<h3 id="patch-validation">Patch Validation</h3>
<p>Same as the <code>create</code> and <code>update</code> methods, but with different name:</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    patch: {
      rules: {
        firstName: [&quot;required&quot;, &quot;min:2&quot;],
        lastName: [&quot;required&quot;, &quot;min:2&quot;],
      },
    },
  };
  //...
}
</code></pre>
<h3 id="patch-events">Patch Events</h3>
<p>Same as the <code>create</code> and <code>update</code> methods, but with different name:</p>
<ul>
<li><code>beforePatch(request: Request, model: Model)</code>: Triggered before patching the record.</li>
<li><code>beforeSave(request: Request, model: Model)</code>: Triggered before creating or update the record.</li>
<li><code>onPatch(request: Request, model: Model, oldModel: Model)</code>: Triggered after patching the record.</li>
<li><code>onSave(request: Request, model: Model, oldModel: Model)</code>: Triggered after creating or patching the record.</li>
</ul>
<p>When patching model, the old data of the model will be sent to events <code>onPatch</code> and <code>onSave</code> methods.</p>
<h3 id="return-type-2">Return Type</h3>
<p>When patching an existing record, you can return two types of responses:</p>
<ul>
<li><code>Single Record</code>: The patched record, <strong>this is the default behavior</strong>.</li>
<li><code>List</code>: which calls the <code>list</code> method and returns the list of records.</li>
</ul>
<p>To change the default behavior, define a <code>returnOn</code> property with <code>patch</code> key in the controller.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...

class RestfulUsers&lt;User&gt; extends Restful {
  //...
  /**
   * {@inheritDoc}
   */
  protected returnOn = {
    patch: &quot;record&quot;, // record | records
  };
  //...
}
</code></pre>
<h2 id="validate-all">Validate All</h2>
<p>If you noticed in our previous create and update examples, the rules are pretty much the same, to avoid this, we can define a <code>validation.all</code> property in the controller.</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/controllers/restful-users.ts&quot;">//...

class RestfulUsers&lt;User&gt; extends Restful {
  //...

  /**
   * {@inheritDoc}
   */
  public validation: RouteResource[&quot;validation&quot;] = {
    all: {
      rules: {
        firstName: [&quot;required&quot;, &quot;min:2&quot;],
        lastName: [&quot;required&quot;, &quot;min:2&quot;],
      },
    },
  };
  //...
}
</code></pre>
<p>This validation will be applied on the three methods: <code>create</code>, <code>update</code>, and <code>patch</code>.</p>
<h2 id="delete-single-record">Delete single record</h2>
<p>The <code>delete</code> method will be called when a request to <code>/users/:id</code> is sent with <code>DELETE</code> method.</p>
<p>If the record does not exist, a <code>404</code> response is returned.</p>
<ul>
<li><code>beforeDelete(model: Model)</code> event is triggered before deleting the record.</li>
<li><code>onDelete(model: Model)</code> event is triggered after deleting the record.</li>
</ul>
<p>The return type will be either to return all records from the <code>restful.list</code> method or just return success response.</p>
<h2 id="bulk-delete">Bulk Delete</h2>
<p>The <code>bulkDelete</code> method will be called when a request to <code>/users</code> is sent with <code>DELETE</code> method.</p>
<p>It&#x27;s very beneficial when you want to delete multiple records at once, this will reduce the round trips to the server.</p>
<p>Simple send a <code>/users</code> with <code>DELETE</code> method with the following body:</p>
<pre><code class="language-json">{
  &quot;id&quot;: [1, 2, 3]
}
</code></pre>
<p>This will delete all records with ids <code>1</code>, <code>2</code>, and <code>3</code>.</p>
<blockquote>
<p>Same events and return type as the <code>delete</code> method, the events will be applied on every single record that will be deleted.</p>
</blockquote>
<p>If the return type is not <code>records</code> then total deleted models will be returned in response key <code>deleted</code>.</p>
<h2 id="replacing-resource-methods">Replacing resource methods</h2>
<p>In some situation we want to use the same restful object, but we need to use another method for certain request, for example we can use the same restful class for users and customers which they are both the same collection, except that in the <code>customers</code> request we want to add <code>isCustomer</code> with value <code>true</code> to the request inputs.</p>
<p>To do so we can use the <code>replace</code> object when defining the route resource to update the <code>list</code> method</p>
<pre><code class="language-ts" metastring="title=&quot;app/users/routes.ts&quot;">import { router } from &quot;@warlock.js/core&quot;;
import restfulUsers from &quot;app/users/controllers/restful-users&quot;;
import ListCustomers from &quot;app/users/controllers/list-customers&quot;;

router.restfulResource(&quot;users&quot;, restfulUsers, {
  replace: {
    list: ListCustomers,
  },
});
</code></pre></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/warlock/http/output"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Output</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/repositories"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Repositories</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#restful-class" class="table-of-contents__link toc-highlight">Restful class</a></li><li><a href="#declaring-a-restful-controller" class="table-of-contents__link toc-highlight">Declaring a Restful controller</a></li><li><a href="#restful-methods" class="table-of-contents__link toc-highlight">Restful methods</a></li><li><a href="#defining-restful-routes" class="table-of-contents__link toc-highlight">Defining restful routes</a></li><li><a href="#list-method" class="table-of-contents__link toc-highlight">List Method</a><ul><li><a href="#change-default-records-key" class="table-of-contents__link toc-highlight">Change default records key</a></li><li><a href="#list-middleware" class="table-of-contents__link toc-highlight">List middleware</a></li></ul></li><li><a href="#get-method" class="table-of-contents__link toc-highlight">Get Method</a><ul><li><a href="#get-middleware" class="table-of-contents__link toc-highlight">Get middleware</a></li><li><a href="#get-response-key" class="table-of-contents__link toc-highlight">Get response key</a></li></ul></li><li><a href="#create-method" class="table-of-contents__link toc-highlight">Create Method</a><ul><li><a href="#create-validation" class="table-of-contents__link toc-highlight">Create Validation</a></li><li><a href="#create-events" class="table-of-contents__link toc-highlight">Create Events</a></li><li><a href="#return-type" class="table-of-contents__link toc-highlight">Return Type</a></li></ul></li><li><a href="#update-method" class="table-of-contents__link toc-highlight">Update Method</a><ul><li><a href="#update-validation" class="table-of-contents__link toc-highlight">Update Validation</a></li><li><a href="#update-events" class="table-of-contents__link toc-highlight">Update Events</a></li><li><a href="#return-type-1" class="table-of-contents__link toc-highlight">Return Type</a></li></ul></li><li><a href="#patch-method" class="table-of-contents__link toc-highlight">Patch Method</a><ul><li><a href="#patch-validation" class="table-of-contents__link toc-highlight">Patch Validation</a></li><li><a href="#patch-events" class="table-of-contents__link toc-highlight">Patch Events</a></li><li><a href="#return-type-2" class="table-of-contents__link toc-highlight">Return Type</a></li></ul></li><li><a href="#validate-all" class="table-of-contents__link toc-highlight">Validate All</a></li><li><a href="#delete-single-record" class="table-of-contents__link toc-highlight">Delete single record</a></li><li><a href="#bulk-delete" class="table-of-contents__link toc-highlight">Bulk Delete</a></li><li><a href="#replacing-resource-methods" class="table-of-contents__link toc-highlight">Replacing resource methods</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 mentoor.io, Inc.</div></div></div></footer></div>
</body>
</html>