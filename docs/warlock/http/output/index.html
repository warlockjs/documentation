<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-warlock/http/output" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Output | Warlock.js</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mentoor.io/logo.svg"><meta data-rh="true" name="twitter:image" content="https://mentoor.io/logo.svg"><meta data-rh="true" property="og:url" content="https://warlock.js.org/docs/warlock/http/output"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Output | Warlock.js"><meta data-rh="true" name="description" content="Outputs are classes that are used to map the models to the response body."><meta data-rh="true" property="og:description" content="Outputs are classes that are used to map the models to the response body."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://warlock.js.org/docs/warlock/http/output"><link data-rh="true" rel="alternate" href="https://warlock.js.org/docs/warlock/http/output" hreflang="en"><link data-rh="true" rel="alternate" href="https://warlock.js.org/docs/warlock/http/output" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f72f589a.css">
<script src="/assets/js/runtime~main.b156083d.js" defer="defer"></script>
<script src="/assets/js/main.e6d1dc1a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://mentoor.io/logo.svg" alt="mentoor.io" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://mentoor.io/logo.svg" alt="mentoor.io" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Warlock.js EcoSystem</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/warlock/getting-started/introduction">Warlock</a><a class="navbar__item navbar__link" href="/docs/cascade/getting-started/introduction">Cascade</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hassanzohdy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/database">Database</a><button aria-label="Expand sidebar category &#x27;Database&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/http-requests">Http Requests</a><button aria-label="Collapse sidebar category &#x27;Http Requests&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/routes">Routes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/configurations">Http configurations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/request">Request</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/uploaded-files">Uploaded Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/middleware">Middleware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/response">Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/request-context">Request Context</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/warlock/http/output">Output</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/warlock/http/restful">Restful API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/repositories">Repositories</a><button aria-label="Expand sidebar category &#x27;Repositories&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/validation">Validation</a><button aria-label="Expand sidebar category &#x27;Validation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/auth">Auth</a><button aria-label="Expand sidebar category &#x27;Auth&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/localization">Localization</a><button aria-label="Expand sidebar category &#x27;Localization&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/uploads">Uploads</a><button aria-label="Expand sidebar category &#x27;Uploads&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/cache">Cache</a><button aria-label="Expand sidebar category &#x27;Cache&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/image">Image</a><button aria-label="Expand sidebar category &#x27;Image&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/mail">Mail</a><button aria-label="Expand sidebar category &#x27;Mail&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/log">Log</a><button aria-label="Expand sidebar category &#x27;Log&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/utils">Utils</a><button aria-label="Expand sidebar category &#x27;Utils&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/production">Production</a><button aria-label="Expand sidebar category &#x27;Production&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/advanced">Advanced</a><button aria-label="Expand sidebar category &#x27;Advanced&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/http-requests"><span itemprop="name">Http Requests</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Output</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1 id="output">Output</h1>
<p>Outputs are classes that are used to map the models to the response body.</p>
<h2 id="how-it-works">How it works</h2>
<p>When we return a response from a controller, we send the model instance, for example the user model will be sent to the user.</p>
<p>As mentioned in <a href="./response#sending-custom-objects-to-response">Sending Custom Objects</a> the response parser does not know what data will be sent from the model, this were Outputs come in handy.</p>
<p>So the output takes a <code>resource</code> which could be an instance of a model, or a plain object. then when the response parser start parsing the body, the output class will return the <code>response data</code> which is the final output that will be sent to the client.</p>
<h2 id="creating-an-output">Creating an output</h2>
<p>Create inside <code>src/users/output</code> a file and name it <code>user-output.ts</code> with the following content</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/output/user-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    name: &quot;string&quot;,
    email: &quot;string&quot;,
    age: &quot;number&quot;,
  };
}
</code></pre>
<p>the output class does not really have to much to do, it just ensures that the output data is sent in the correct format.</p>
<p>Now let&#x27;s update our user model class to link it with the user output</p>
<pre><code class="language-ts" metastring="{12,23} title=&quot;src/users/models/user/user.ts&quot;">import {
  castEmail,
  castModel,
  Casts,
  CustomCasts,
  Document,
  expiresAfter,
  oneOf,
} from &quot;@warlock.js/cascade&quot;;
import { Auth, uploadable } from &quot;@warlock.js/core&quot;;
import castPassword from &quot;app/users/utils/cast-password&quot;;
import UserOutput from &quot;../../output/user-output&quot;;

export class User extends Auth {
  /**
   * Collection name
   */
  public static collection = &quot;users&quot;;

  /**
   * Output handler
   */
  public static output = UserOutput;

  /**
   * {@inheritDoc}
   */
  protected casts: Casts = {
    name: &quot;string&quot;,
    gender: &quot;string&quot;,
    image: uploadable,
    email: castEmail,
  };
}
</code></pre>
<p>In the previous model class, we added a static property called <code>output</code> and set it to the <code>UserOutput</code> class.</p>
<p>Now whenever an instance of the model is sent to the response, the data of the model will be transformed using the <code>UserOutput</code> class.</p>
<h3 id="outputs-in-outputs">Outputs in Outputs</h3>
<p>Let&#x27;s take this scenario, a post has a <code>author</code> object which is an embedded document for the user,
and we want to send the post with the author data.</p>
<p>Let&#x27;s see how we can do this.</p>
<p>First we need to create a new output class for the post, and add the author output to it.</p>
<pre><code class="language-ts" metastring="title=&quot;src/posts/output/post-output.ts&quot;">import { FinalOutput, Output } from &quot;@warlock.js/core&quot;;
import { UserOutput } from &quot;app/users/output/user-output&quot;;

export class PostOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    title: &quot;string&quot;,
    content: &quot;string&quot;,
    author: UserOutput,
  };
}
</code></pre>
<p>Now let&#x27;s create a new post model class and link it with the post output</p>
<pre><code class="language-ts" metastring="{12,23} title=&quot;src/posts/models/post/post.ts&quot;">import { castModel, Casts, Document } from &quot;@warlock.js/cascade&quot;;
import { Model, uploadable } from &quot;@warlock.js/core&quot;;
import { User } from &quot;app/users/models/user/user&quot;;

export class Post extends Model {
  /**
   * Collection name
   */
  public static collection = &quot;posts&quot;;

  /**
   * Output handler
   */
  public static output = PostOutput;

  /**
   * {@inheritDoc}
   */
  protected casts: Casts = {
    title: &quot;string&quot;,
    content: &quot;string&quot;,
    author: castModel(User),
  };
}
</code></pre>
<p>Now the post has title, content and the embedded data of the author.</p>
<p>Let&#x27;s create a new post</p>
<pre><code class="language-ts" metastring="title=&quot;src/posts/controllers/create-post.ts&quot;">import { Request, Response } from &quot;@warlock.js/core&quot;;
import { Post } from &quot;../models/post/post&quot;;
import { User } from &quot;app/users/models/user&quot;;

export async function createPost(request: Request, response: Response) {
  const user = await User.find(request.input(&quot;authorId&quot;));

  if (!user) {
    return response.notFound();
  }

  const post = new Post({
    title: request.input(&quot;title&quot;),
    content: request.input(&quot;content&quot;),
    user,
  });

  await post.save();

  return response.success({
    post,
  });
}
</code></pre>
<p>Now the post will be returned, the <code>castModel</code> in the post model will set the embedded data of the user into the post&#x27;s author field so the post data in database will look like:</p>
<pre><code class="language-json">{
  &quot;id&quot;: 1,
  &quot;title&quot;: &quot;Post title&quot;,
  &quot;content&quot;: &quot;Post content&quot;,
  &quot;author&quot;: {
    &quot;id&quot;: 1,
    &quot;image&quot;: {
      &quot;path&quot;: &quot;users/1/image.png&quot;
    },
    &quot;name&quot;: &quot;User name&quot;,
    &quot;email&quot;: &quot;my-email@gmail.com&quot;
  }
}
</code></pre>
<p>Thanks to the <code>PostOutput</code> only the needed data will be sent to the response.</p>
<p>But as you can see in the previous example, the post&#x27;s author has an image, but we didn&#x27;t define it yet in the user output, most of the time the image is an instance of <code>Upload</code> model, which already is built in inside Warlock and has as well <code>UploadOutput</code> class.</p>
<p>Let&#x27;s update the user output to include the image</p>
<pre><code class="language-ts" metastring="{12,23} title=&quot;src/users/output/user-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    name: &quot;string&quot;,
    email: &quot;string&quot;,
    age: &quot;number&quot;,
    image: UploadOutput,
  };
}
</code></pre>
<p>Now the image will be sent to the response as well.</p>
<p>But since the embedded data doesn&#x27;t include the user <code>age</code> then it will not be returned.</p>
<h3 id="custom-output-handler">Custom output handler</h3>
<p>We can also define a method in the output class to handle the output data.</p>
<p>Let&#x27;s take this scenario, we want to return the user&#x27;s full name instead of the first name only.</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/output/user-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    email: &quot;string&quot;,
    age: &quot;number&quot;,
    fullName: this.handleFullName,
  };

  /**
   * Get the full name
   */
  public handleFullName() {
    return this.get(&quot;firstName&quot;) + &quot; &quot; + this.get(&quot;lastName&quot;);
  }
}
</code></pre>
<h2 id="extending-output">Extending output</h2>
<p>When the application grows, it gets complicated, so we may face a situation where we need to add a new field to the output, but it requires more than just a simple output key, this where <code>extend</code> method comes in handy.</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/output/user-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    email: &quot;string&quot;,
    age: &quot;number&quot;,
    fullName: this.handleFullName,
  };

  /**
   * Get the full name
   */
  public handleFullName() {
    return this.get(&quot;firstName&quot;) + &quot; &quot; + this.get(&quot;lastName&quot;);
  }

  /**
   * Extend the output
   */
  protected async extend() {
    if (this.get(&quot;id&quot;) === 1) {
      this.set(&quot;isAdmin&quot;, true);
    }
  }
}
</code></pre>
<p>We made a check to see if the user id is 1, then we set the <code>isAdmin</code> field to true.</p>
<h3 id="working-with-output-without-models">Working with output without models.</h3>
<p>Let&#x27;s see how it works without a model</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/controllers/get-user.ts&quot;">import { Request, Response } from &quot;@warlock.js/core&quot;;
import { UserOutput } from &quot;../output/user-output&quot;;

export async function getUser(request: Request, response: Response) {
  const user = {
    id: 1,
    firstName: &quot;John&quot;,
    lastName: &quot;Doe&quot;,
  };

  const output = new UserOutput(user);

  return response.success({
    user: output,
  });
}
</code></pre>
<p>As you can see, the output class can take a plain object, or an instance of a model, they both are called <code>output resource</code>.</p>
<h3 id="get-value-from-teh-resource">Get value from teh resource</h3>
<p>In our previous user output, we used <code>get</code> method to get the value from the passed <code>resource</code>, this allows us to get any value from the given resource using dot notation.</p>
<pre><code class="language-ts" metastring="{29} title=&quot;src/users/output/user-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    email: &quot;string&quot;,
    age: &quot;number&quot;,
    fullName: this.handleFullName,
  };

  /**
   * Get the full name
   */
  public handleFullName() {
    return this.get(&quot;firstName&quot;) + &quot; &quot; + this.get(&quot;lastName&quot;);
  }

  /**
   * Extend the output
   */
  protected async extend() {
    if (this.get(&quot;id&quot;) === 1) {
      this.set(&quot;isAdmin&quot;, true);
    }

    this.set(&quot;address&quot;, this.get(&quot;location.address&quot;));
  }
}
</code></pre>
<p>And of course the <code>set</code> method is to set a value to the output data that will be sent to the response.</p>
<h3 id="output-from-array">Output from array</h3>
<p>If the data is stored in array, using <code>UserOutput.collect</code> static method will return an array of output resources.</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/controllers/get-users.ts&quot;">import { Request, Response } from &quot;@warlock.js/core&quot;;
import { UserOutput } from &quot;../output/user-output&quot;;

export async function getUsers(request: Request, response: Response) {
  const users = [
    {
      id: 1,
      firstName: &quot;John&quot;,
      lastName: &quot;Doe&quot;,
    },
    {
      id: 2,
      firstName: &quot;Jane&quot;,
      lastName: &quot;Doe&quot;,
    },
  ];

  const output = UserOutput.collect(users);

  return response.success({
    users: output,
  });
}
</code></pre>
<h3 id="removing-value-from-the-data-output">Removing value from the data output</h3>
<p>To remove a value from the response data, use <code>remove</code> method.</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/output/user-output.ts&quot;">import {
  requestContext,
  FinalOutput,
  Output,
  UploadOutput,
} from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    email: &quot;string&quot;,
    age: &quot;number&quot;,
    fullName: this.handleFullName,
    salary: &quot;float&quot;,
  };

  /**
   * Get the full name
   */
  public handleFullName() {
    return this.get(&quot;firstName&quot;) + &quot; &quot; + this.get(&quot;lastName&quot;);
  }

  /**
   * Extend the output
   */
  protected async extend() {
    if (this.get(&quot;id&quot;) === 1) {
      this.set(&quot;isAdmin&quot;, true);
    }

    this.set(&quot;address&quot;, this.get(&quot;location.address&quot;));

    this.remove(&quot;location&quot;);

    const { user } = requestContext();

    // show salary only for admins
    if (!user || user.get(&quot;isAdmin&quot;) === false) {
      this.remove(&quot;salary&quot;);
    }
  }
}
</code></pre>
<p>In this example, we got the user object from the request context, and we checked if the user is admin or not, if not we removed the salary from the output data.</p>
<h2 id="built-in-types">Built-in types</h2>
<p>Warlock has some built-in types that can be used in the output class.</p>
<ul>
<li><code>int</code>: integer number.</li>
<li><code>float</code>: float number.</li>
<li><code>number</code>: Integer or float number based on the value.</li>
<li><code>string</code>: string.</li>
<li><code>boolean | bool</code>: boolean.</li>
<li><code>date</code>: date.</li>
<li><code>array</code>: Makes sure the returned value is an array.</li>
<li><code>object</code>: Makes sure the returned value is an object.</li>
<li><code>localized</code>: Makes sure the returned value is a string contains the value against the current locale code, <a href="./../localization/detecting-locale-code">Read more about localization detection from localization section</a>.</li>
<li><code>location</code>: It will parse MongoDB <a href="https://www.mongodb.com/docs/manual/reference/geojson/#point/">GeoJSON</a> object and return the latitude and longitude. in <code>{ lat, lng }</code> format.</li>
</ul>
<h3 id="date-format">Date Format</h3>
<p>When dealing with date objects, Warlock will format it in multiple formats, so for each date object is sent to the output, the response shape will be like this:</p>
<pre><code class="language-json">{
  &quot;createdAt&quot;: {
    &quot;format&quot;: &quot;13-07-2023 07:36:31 AM&quot;,
    &quot;timestamp&quot;: 1689222991000,
    &quot;humanTime&quot;: &quot;4 months ago&quot;,
    &quot;text&quot;: &quot;July 13, 2023 at 7:36:31 AM&quot;,
    &quot;date&quot;: &quot;July 13, 2023&quot;
  }
}
</code></pre>
<p>This give the client developer (Web or mobile apps) the ability to use the date in the format they want.</p>
<p>To customize the format of the <code>format</code> you can override it in the output class by defining <code>dateFormat</code> property:</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/output/user-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  //...
  protected dateFormat = &quot;DD-MM-YYYY&quot;;
}
</code></pre>
<admonition type="note"><p>Date format is being transformed using <a href="https://day.js.org/docs/en/display/format">Day.js</a> library.</p></admonition>
<h3 id="renaming-output-key">Renaming output key</h3>
<p>If we want to send another key instead of the original key in the resource, add the returning key to the response as the key, and the value will be an array contains two values, the first value will be the key that will be taken from the <code>resource</code> and the second value will be the format.</p>
<pre><code class="language-ts" metastring="{11} title=&quot;src/users/output/user-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;

export class UserOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    email: &quot;string&quot;,
    age: &quot;number&quot;,
    salary: [&quot;monthlySalary&quot;, &quot;float&quot;],
  };
}
</code></pre>
<h2 id="manually-using-the-output-class">Manually using the output class</h2>
<p>It&#x27;s not just related to Warlock response, you can use it to filter the given data and be sent in a certain format based on the output data.</p>
<p>In that sense, you can use it in any place in your application.</p>
<pre><code class="language-ts" metastring="title=&quot;src/users/controllers/get-user.ts&quot;">import { UserOutput } from &quot;../output/user-output&quot;;

async function main() {
  const userOutput = new UserOutput({
    id: 1,
    firstName: &quot;John&quot;,
    lastName: &quot;Doe&quot;,
    age: new Date().getFullYear() - 1990,
  });

  const output = await userOutput.toJSON();
}

main();
</code></pre>
<h2 id="array-of-outputs">Array Of Outputs</h2>
<p>In some scenarios, there is a field where it holds a list of objects, each object may point to an output, for example, a product output may have a list of <code>options</code> where each option has an <code>option</code> object and a <code>value</code> object that are taken from <code>options</code> and <code>optionValues</code> models/outputs, so in this case we need to use <code>arrayOf</code> method to map the <code>product options</code> to the <code>option</code> and <code>option value</code> outputs.</p>
<pre><code class="language-ts" metastring="title=&quot;src/products/output/product-output.ts&quot;">import { FinalOutput, Output, UploadOutput } from &quot;@warlock.js/core&quot;;
import { OptionOutput } from &quot;app/options/output/option-output&quot;;
import { OptionValueOutput } from &quot;app/options/output/option-value-output&quot;;

export class ProductOutput extends Output {
  /**
   * Output data
   */
  protected output: FinalOutput = {
    id: &quot;int&quot;,
    title: &quot;string&quot;,
    options: this.arrayOf({
      option: OptionOutput,
      value: OptionValueOutput,
    }),
  };
}
</code></pre></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/warlock/http/request-context"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Request Context</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/warlock/http/restful"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Restful API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How it works</a></li><li><a href="#creating-an-output" class="table-of-contents__link toc-highlight">Creating an output</a><ul><li><a href="#outputs-in-outputs" class="table-of-contents__link toc-highlight">Outputs in Outputs</a></li><li><a href="#custom-output-handler" class="table-of-contents__link toc-highlight">Custom output handler</a></li></ul></li><li><a href="#extending-output" class="table-of-contents__link toc-highlight">Extending output</a><ul><li><a href="#working-with-output-without-models" class="table-of-contents__link toc-highlight">Working with output without models.</a></li><li><a href="#get-value-from-teh-resource" class="table-of-contents__link toc-highlight">Get value from teh resource</a></li><li><a href="#output-from-array" class="table-of-contents__link toc-highlight">Output from array</a></li><li><a href="#removing-value-from-the-data-output" class="table-of-contents__link toc-highlight">Removing value from the data output</a></li></ul></li><li><a href="#built-in-types" class="table-of-contents__link toc-highlight">Built-in types</a><ul><li><a href="#date-format" class="table-of-contents__link toc-highlight">Date Format</a></li><li><a href="#renaming-output-key" class="table-of-contents__link toc-highlight">Renaming output key</a></li></ul></li><li><a href="#manually-using-the-output-class" class="table-of-contents__link toc-highlight">Manually using the output class</a></li><li><a href="#array-of-outputs" class="table-of-contents__link toc-highlight">Array Of Outputs</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 mentoor.io, Inc.</div></div></div></footer></div>
</body>
</html>