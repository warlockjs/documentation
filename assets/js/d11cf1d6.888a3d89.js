"use strict";(self.webpackChunkmongez_docs=self.webpackChunkmongez_docs||[]).push([[5719],{8938:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var r=n(4848),o=n(5680);const i={sidebar_position:3},s="Http configurations",a={id:"warlock/http/configurations",title:"Http configurations",description:"Http configurations are used to set the default http configurations, like the port, host, and other configurations.",source:"@site/docs/warlock/http/configurations.mdx",sourceDirName:"warlock/http",slug:"/warlock/http/configurations",permalink:"/docs/warlock/http/configurations",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"warlock",previous:{title:"Routes",permalink:"/docs/warlock/http/routes"},next:{title:"Request",permalink:"/docs/warlock/http/request"}},l={},c=[{value:"Defining http configurations",id:"defining-http-configurations",level:2},{value:"Http port",id:"http-port",level:3},{value:"Rate Limit",id:"rate-limit",level:3},{value:"Cors",id:"cors",level:2},{value:"Why Cors?",id:"why-cors",level:3},{value:"Cors configurations",id:"cors-configurations",level:3},{value:"Cors Origin",id:"cors-origin",level:3},{value:"Cors Methods",id:"cors-methods",level:3}];function d(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.RP)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"http-configurations",children:"Http configurations"}),"\n",(0,r.jsx)(t.p,{children:"Http configurations are used to set the default http configurations, like the port, host, and other configurations."}),"\n",(0,r.jsx)(t.h2,{id:"defining-http-configurations",children:"Defining http configurations"}),"\n",(0,r.jsxs)(t.p,{children:["Let's go to our ",(0,r.jsx)(t.code,{children:"src/config/http.ts"})," file and define the http configurations."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="src/config/http.ts"',children:'import { env } from "@mongez/dotenv";\r\nimport { HttpConfigurations } from "@warlock.js/core";\r\n\r\nconst httpConfigurations: HttpConfigurations = {\r\n  port: env("PORT", 3000),\r\n  host: env("HOST", "localhost"),\r\n  log: true,\r\n  fileUploadLimit: 12 * 1024 * 1024 * 1024,\r\n  rateLimit: {\r\n    max: 260,\r\n    duration: 60 * 1000, // 1 minute\r\n  },\r\n  cors: {\r\n    // allowed origins\r\n    origin: "*", // change it to the list of allowed origins or a string\r\n    // allowed methods\r\n    methods: ["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"],\r\n  },\r\n  middleware: {\r\n    // apply the middleware to all routes\r\n    all: [],\r\n    // apply the middleware to specific routes\r\n    only: {\r\n      // Example:\r\n      // routes: [],\r\n      // namedRoutes: ["users.list"],\r\n      // middleware: [authMiddleware("user")],\r\n      routes: [],\r\n      namedRoutes: [],\r\n      middleware: [],\r\n    },\r\n    // exclude the middleware from specific routes\r\n    except: {\r\n      routes: [],\r\n      namedRoutes: [],\r\n      middleware: [],\r\n    },\r\n  },\r\n};\r\n\r\nexport default httpConfigurations;\n'})}),"\n",(0,r.jsx)(t.p,{children:"Let's break down the above code:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"port"}),": The port that the application will run on, default to ",(0,r.jsx)(t.code,{children:"3000"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"host"}),": The host that the application will run on, default to ",(0,r.jsx)(t.code,{children:"localhost"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"log"}),": Enable or disable the http logs, default to ",(0,r.jsx)(t.code,{children:"true"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"fileUploadLimit"}),": The file upload limit, if not defined in env then set it to ",(0,r.jsx)(t.code,{children:"12 * 1024 * 1024 * 1024"})," (12 MB), default is ",(0,r.jsx)(t.code,{children:"10 MB"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"rateLimit"}),": The rate limit configurations, it's used to limit the number of requests per minute, default to ",(0,r.jsx)(t.code,{children:"60"})," requests per minute but we applied it to ",(0,r.jsx)(t.code,{children:"260"})," requests per minute."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"middleware"}),": The middleware configurations, it's used to apply the middleware to all routes, or to specific routes, or to exclude the middleware from specific routes."]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"http-port",children:"Http port"}),"\n",(0,r.jsxs)(t.p,{children:["If port is being used in development mode, then ",(0,r.jsx)(t.code,{children:"Warlock"})," will try to find another port to run the application on."]}),"\n",(0,r.jsx)(t.h3,{id:"rate-limit",children:"Rate Limit"}),"\n",(0,r.jsx)(t.p,{children:"Rate limit is used to limit the number of requests per minute, it's useful to prevent the application from being attacked by sending a lot of requests in a short time."}),"\n",(0,r.jsxs)(t.p,{children:["The default value is ",(0,r.jsx)(t.code,{children:"60"})," requests per minute, but if the application has a lot of requests, then you can increase the value as applied above."]}),"\n",(0,r.jsx)(t.h2,{id:"cors",children:"Cors"}),"\n",(0,r.jsxs)(t.p,{children:["Cors stands for ",(0,r.jsx)(t.code,{children:"Cross-Origin Resource Sharing"}),", it's a mechanism that allows a web application running at one origin to access the resources from a server running at a different origin."]}),"\n",(0,r.jsx)(t.h3,{id:"why-cors",children:"Why Cors?"}),"\n",(0,r.jsxs)(t.p,{children:["Cors is used to make sure that the application can access the resources from a different origin, for example, if you have a frontend application running on ",(0,r.jsx)(t.code,{children:"https://example.com"})," and you have an API running on ",(0,r.jsx)(t.code,{children:"https://api.example.com"})," then you need to enable Cors to make sure that the frontend application can access the API."]}),"\n",(0,r.jsx)(t.h3,{id:"cors-configurations",children:"Cors configurations"}),"\n",(0,r.jsxs)(t.p,{children:["By default, ",(0,r.jsx)(t.code,{children:"Warlock"})," allows all origins, but you can change this behavior by setting the value of ",(0,r.jsx)(t.code,{children:"cors"})," to the list of allowed origins."]}),"\n",(0,r.jsx)(t.h3,{id:"cors-origin",children:"Cors Origin"}),"\n",(0,r.jsxs)(t.p,{children:["As mentioned above the ",(0,r.jsx)(t.code,{children:"origin"})," is used to set the list of allowed origins."]}),"\n",(0,r.jsxs)(t.p,{children:["If ",(0,r.jsx)(t.code,{children:"origin"})," is set to ",(0,r.jsx)(t.code,{children:"*"})," it will accept all origins, but if you want to set a list of allowed origins you can set it to an array of strings."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="src/config/http.ts"',children:'const corsConfigurations = {\r\n  // allowed origins\r\n  origin: ["https://example.com", "https://api.example.com"],\r\n  // allowed methods\r\n  methods: ["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"],\r\n};\n'})}),"\n",(0,r.jsx)(t.p,{children:"Or you can just pass a string to it."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="src/config/http.ts"',children:'const corsConfigurations = {\r\n  // allowed origins\r\n  origin: "https://example.com",\r\n  // allowed methods\r\n  methods: ["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"],\r\n};\n'})}),"\n",(0,r.jsx)(t.h3,{id:"cors-methods",children:"Cors Methods"}),"\n",(0,r.jsxs)(t.p,{children:["Probably you don't need to change this, but if you want to change the allowed methods you can change it by setting the value of ",(0,r.jsx)(t.code,{children:"methods"})," to the list of allowed methods."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="src/config/http.ts"',children:'const corsConfigurations = {\r\n  // allowed origins\r\n  origin: "*",\r\n  // allowed methods\r\n  methods: ["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"],\r\n};\n'})}),"\n",(0,r.jsx)(t.admonition,{type:"warning",children:(0,r.jsxs)(t.p,{children:["Be aware that browsers use the ",(0,r.jsx)(t.code,{children:"OPTIONS"})," method to check if the API is allowed to be accessed from the frontend application, so make sure to add it to the list of allowed methods."]})})]})}function h(e={}){const{wrapper:t}={...(0,o.RP)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},5680:(e,t,n)=>{n.d(t,{RP:()=>c});var r=n(6540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,h=a(e,["components","mdxType","originalType","parentName"]),u=c(n),p=o,f=u["".concat(l,".").concat(p)]||u[p]||d[p]||i;return n?r.createElement(f,s(s({ref:t},h),{},{components:n})):r.createElement(f,s({ref:t},h))}));h.displayName="MDXCreateElement"}}]);