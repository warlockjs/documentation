"use strict";(self.webpackChunkmongez_docs=self.webpackChunkmongez_docs||[]).push([[3662],{1673:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>c,metadata:()=>a,toc:()=>s});var i=n(4848),t=n(5680);const c={sidebar_position:8},o="File Cache Driver",a={id:"warlock/cache/file",title:"File Cache Driver",description:"File Cache Driver is a cache driver that stores cached data in files.",source:"@site/docs/warlock/cache/file.mdx",sourceDirName:"warlock/cache",slug:"/warlock/cache/file",permalink:"/docs/warlock/cache/file",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"warlock",previous:{title:"Memory Cache Driver",permalink:"/docs/warlock/cache/memory"},next:{title:"Database Cache Driver",permalink:"/docs/warlock/cache/database"}},l={},s=[{value:"Setup",id:"setup",level:2},{value:"Options",id:"options",level:2},{value:"Usage",id:"usage",level:2},{value:"Storing mechanism",id:"storing-mechanism",level:2},{value:"Expired cache",id:"expired-cache",level:2}];function h(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.RP)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h1,{id:"file-cache-driver",children:"File Cache Driver"}),"\n",(0,i.jsx)(r.p,{children:"File Cache Driver is a cache driver that stores cached data in files."}),"\n",(0,i.jsx)(r.h2,{id:"setup",children:"Setup"}),"\n",(0,i.jsxs)(r.p,{children:["In the ",(0,i.jsx)(r.a,{href:"./configurations",children:"Cache Configurations"})," file, add the following:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",metastring:'title="src/config/cache.ts"',children:'import { env } from "@mongez/dotenv";\r\nimport { CacheConfigurations, FileCacheDriver } from "@warlock.js/core";\r\n\r\nconst cacheConfigurations: CacheConfigurations = {\r\n  drivers: {\r\n    file: FileCacheDriver,\r\n  },\r\n  default: env("CACHE_DRIVER", "file"),\r\n  options: {\r\n    file: {\r\n      ttl: 60 * 60 * 24, // 24 hours\r\n    },\r\n  },\r\n};\r\n\r\nexport default cacheConfigurations;\n'})}),"\n",(0,i.jsx)(r.h2,{id:"options",children:"Options"}),"\n",(0,i.jsx)(r.p,{children:"Cache driver has the following options:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"globalPrefix"}),": A prefix that will be added to all keys. This is useful when you want to use the same cache driver for multiple applications, it could be a ",(0,i.jsx)(r.code,{children:"string"})," or a callback that returns a ",(0,i.jsx)(r.code,{children:"string"}),", if not provided then there will no be prefix for the keys."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"ttl"}),": Time to live in seconds, the default value is ",(0,i.jsx)(r.code,{children:"Infinity"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"directory"}),": The directory where the cache files will be stored, the default value is ",(0,i.jsx)(r.code,{children:"storage/cache"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"fileName"}),": The file name that will be used to store the cache data, the default value is ",(0,i.jsx)(r.code,{children:"cache.json"}),"."]}),"\n"]}),"\n",(0,i.jsx)(r.admonition,{type:"info",children:(0,i.jsxs)(r.p,{children:["When defining ",(0,i.jsx)(r.code,{children:"directory"})," property, make sure to define the entire path, not just the directory name."]})}),"\n",(0,i.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(r.p,{children:"To use the file cache driver, you need to define it in the drivers list in the cache configurations file:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ts",metastring:'title="src/config/cache.ts"',children:'import { env } from "@mongez/dotenv";\r\nimport { CacheConfigurations, FileCacheDriver } from "@warlock.js/core";\r\n\r\nconst cacheConfigurations: CacheConfigurations = {\r\n  drivers: {\r\n    file: FileCacheDriver,\r\n  },\r\n  default: env("CACHE_DRIVER", "file"),\r\n  options: {\r\n    file: {\r\n      globalPrefix: "online-store",\r\n      ttl: 60 * 60 * 24, // 24 hours\r\n    },\r\n  },\r\n};\r\n\r\nexport default cacheConfigurations;\n'})}),"\n",(0,i.jsxs)(r.p,{children:["This will allow the cache manager to pick it if there is no ",(0,i.jsx)(r.code,{children:"CACHE_DRIVER"})," environment variable defined."]}),"\n",(0,i.jsx)(r.h2,{id:"storing-mechanism",children:"Storing mechanism"}),"\n",(0,i.jsxs)(r.p,{children:["Each cache key will be considered as a ",(0,i.jsx)(r.code,{children:"directory"})," that has ",(0,i.jsx)(r.code,{children:"cache.json"})," file, this allows us to easily remove the cache key by removing the directory."]}),"\n",(0,i.jsx)(r.h2,{id:"expired-cache",children:"Expired cache"}),"\n",(0,i.jsxs)(r.p,{children:["The driver will validate if there is a ",(0,i.jsx)(r.code,{children:"ttl"})," option in the options, if so, then it will store the expiration time in the cache file, and it will be used to check if the cache is expired or not."]}),"\n",(0,i.jsx)(r.p,{children:"If the cache key is called and it exceeded the cache time, it will be removed."}),"\n",(0,i.jsx)(r.admonition,{type:"danger",children:(0,i.jsx)(r.p,{children:"Cache driver will not make any effort to remove expired cache keys, it will only remove them when they are called."})}),"\n",(0,i.jsx)(r.admonition,{type:"note",children:(0,i.jsxs)(r.p,{children:["Please note that the File Cache Drier implements all methods in ",(0,i.jsx)(r.a,{href:"./cache-driver-interface",children:"Cache Driver Interface"})," so you can use it directly as a cache driver."]})})]})}function d(e={}){const{wrapper:r}={...(0,t.RP)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},5680:(e,r,n)=>{n.d(r,{RP:()=>s});var i=n(6540);function t(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function c(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?c(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function a(e,r){if(null==e)return{};var n,i,t=function(e,r){if(null==e)return{};var n,i,t={},c=Object.keys(e);for(i=0;i<c.length;i++)n=c[i],r.indexOf(n)>=0||(t[n]=e[n]);return t}(e,r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(i=0;i<c.length;i++)n=c[i],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var l=i.createContext({}),s=function(e){var r=i.useContext(l),n=r;return e&&(n="function"==typeof e?e(r):o(o({},r),e)),n},h={inlineCode:"code",wrapper:function(e){var r=e.children;return i.createElement(i.Fragment,{},r)}},d=i.forwardRef((function(e,r){var n=e.components,t=e.mdxType,c=e.originalType,l=e.parentName,d=a(e,["components","mdxType","originalType","parentName"]),f=s(n),p=t,u=f["".concat(l,".").concat(p)]||f[p]||h[p]||c;return n?i.createElement(u,o(o({ref:r},d),{},{components:n})):i.createElement(u,o({ref:r},d))}));d.displayName="MDXCreateElement"}}]);