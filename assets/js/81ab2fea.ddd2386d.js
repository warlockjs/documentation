"use strict";(self.webpackChunkmongez_docs=self.webpackChunkmongez_docs||[]).push([[2929],{325:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>x,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var t=i(4848),s=i(5680);const r={sidebar_position:2},d="Blueprint",l={id:"cascade/indexing/blueprint",title:"Blueprint",description:"MonPulse introduces a Blueprint class, this class easily allows you to create indexes on your collections. You can create indexes on a single field, multiple fields, and compound indexes.",source:"@site/docs/cascade/indexing/blueprint.mdx",sourceDirName:"cascade/indexing",slug:"/cascade/indexing/blueprint",permalink:"/docs/cascade/indexing/blueprint",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"mongodb",previous:{title:"Indexing",permalink:"/docs/cascade/indexing/introduction"},next:{title:"Model Blueprint",permalink:"/docs/cascade/indexing/model-blueprint"}},o={},c=[{value:"Creating a new blueprint",id:"creating-a-new-blueprint",level:2},{value:"Creating a new index",id:"creating-a-new-index",level:2},{value:"Creating a compound index",id:"creating-a-compound-index",level:3},{value:"Creating a unique index",id:"creating-a-unique-index",level:3},{value:"Creating a text index",id:"creating-a-text-index",level:3},{value:"Creating a Geo Index",id:"creating-a-geo-index",level:3},{value:"Dropping indexes",id:"dropping-indexes",level:2},{value:"Drop unique index",id:"drop-unique-index",level:3},{value:"Drop text index",id:"drop-text-index",level:3},{value:"Drop geo index",id:"drop-geo-index",level:3},{value:"Drop all indexes",id:"drop-all-indexes",level:3},{value:"Listing indexes",id:"listing-indexes",level:2},{value:"Check if index exists",id:"check-if-index-exists",level:3},{value:"Get indexes information",id:"get-indexes-information",level:2},{value:"Truncate collection",id:"truncate-collection",level:2},{value:"Drop collection",id:"drop-collection",level:2},{value:"Get collection stats",id:"get-collection-stats",level:2},{value:"Get collection size",id:"get-collection-size",level:2},{value:"Get Indexes Size",id:"get-indexes-size",level:2},{value:"Get total size",id:"get-total-size",level:2},{value:"Get document average size",id:"get-document-average-size",level:2},{value:"Count documents",id:"count-documents",level:2},{value:"The <code>blueprint</code> function",id:"the-blueprint-function",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.RP)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"blueprint",children:"Blueprint"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"MonPulse"})," introduces a ",(0,t.jsx)(n.code,{children:"Blueprint"})," class, this class easily allows you to create indexes on your collections. You can create indexes on a single field, multiple fields, and compound indexes."]}),"\n",(0,t.jsx)(n.h2,{id:"creating-a-new-blueprint",children:"Creating a new blueprint"}),"\n",(0,t.jsxs)(n.p,{children:["To start using ",(0,t.jsx)(n.code,{children:"Blueprint"}),", create an instance of it and pass the collection name to the constructor."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { Blueprint } from "@warlock.js/cascade";\r\n\r\nconst usersBlueprint = new Blueprint("users");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"creating-a-new-index",children:"Creating a new index"}),"\n",(0,t.jsxs)(n.p,{children:["To create a single field index, use the ",(0,t.jsx)(n.code,{children:"index"})," method. The first argument is the field name, and the second argument is the index options."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.index("name"); // creates an index on the name field\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This will create an index on the ",(0,t.jsx)(n.code,{children:"name"})," field. The index name will be ",(0,t.jsx)(n.code,{children:"users_name_index"})," to be easier to follow the naming convention."]}),"\n",(0,t.jsx)(n.p,{children:"If you want to specify a custom index name, pass it as the second argument."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.index("name", { name: "users_name" });\n'})}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-compound-index",children:"Creating a compound index"}),"\n",(0,t.jsx)(n.p,{children:"To create a compound index, use the same method, but pass an array of fields instead of a single field."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.index(["name", "email"]);\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This will create a new index in the ",(0,t.jsx)(n.code,{children:"users"})," collection on the ",(0,t.jsx)(n.code,{children:"name"})," and ",(0,t.jsx)(n.code,{children:"email"})," fields. The index name will be ",(0,t.jsx)(n.code,{children:"users_name_email_index"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Again, you can specify a custom index name."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.index(["name", "email"], { name: "users_name_email" });\n'})}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-unique-index",children:"Creating a unique index"}),"\n",(0,t.jsxs)(n.p,{children:["Similar to the ",(0,t.jsx)(n.code,{children:"index"})," method, you can use the ",(0,t.jsx)(n.code,{children:"unique"})," method to create a unique index."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.unique("email");\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This will enforce only unique values in the ",(0,t.jsx)(n.code,{children:"email"})," field, if email is duplicated the index will throw an error."]}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-text-index",children:"Creating a text index"}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"text"})," index is used to search for text in a collection. To create a text index, use the ",(0,t.jsx)(n.code,{children:"text"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.textIndex("name");\n'})}),"\n",(0,t.jsx)(n.p,{children:"Text indexes are useful when you want to search for text in a collection. For example, if you want to search for users by their name, you can use the text index."}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-geo-index",children:"Creating a Geo Index"}),"\n",(0,t.jsxs)(n.p,{children:["A geo index ",(0,t.jsx)(n.strong,{children:"A.K.A"})," ",(0,t.jsx)(n.code,{children:"2dsphere"})," index is used to store geo data in a collection. To create a geo index, use the ",(0,t.jsx)(n.code,{children:"geoIndex"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.geoIndex("location");\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"DID YOU KNOW?",type:"info",children:(0,t.jsxs)(n.p,{children:["Any ",(0,t.jsx)(n.code,{children:"index method"})," can create a single or compound index. For example, you can create a compound text index by passing an array of fields to any ",(0,t.jsx)(n.code,{children:"index method"}),"."]})}),"\n",(0,t.jsx)(n.admonition,{title:"Index Options",type:"tip",children:(0,t.jsxs)(n.p,{children:["Any ",(0,t.jsx)(n.code,{children:"index method"})," receives two parameters, the first one is for the column(s) that will be indexed, the second one is ",(0,t.jsx)(n.a,{href:"https://docs.mongodb.com/manual/reference/method/db.collection.createIndex/#index-options",children:"Index Options"}),", so you can freely use it as well."]})}),"\n",(0,t.jsx)(n.h2,{id:"dropping-indexes",children:"Dropping indexes"}),"\n",(0,t.jsxs)(n.p,{children:["Dropping indexes are similar to creating them. To drop an index, use the ",(0,t.jsx)(n.code,{children:"dropIndex"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.dropIndex("name");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"drop-unique-index",children:"Drop unique index"}),"\n",(0,t.jsxs)(n.p,{children:["To drop a unique index, use the ",(0,t.jsx)(n.code,{children:"dropUnique"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.dropUnique("email");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"drop-text-index",children:"Drop text index"}),"\n",(0,t.jsxs)(n.p,{children:["To drop a text index, use the ",(0,t.jsx)(n.code,{children:"dropTextIndex"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.dropTextIndex("name");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"drop-geo-index",children:"Drop geo index"}),"\n",(0,t.jsxs)(n.p,{children:["To drop a geo index, use the ",(0,t.jsx)(n.code,{children:"dropGeoIndex"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.dropGeoIndex("location");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"drop-all-indexes",children:"Drop all indexes"}),"\n",(0,t.jsxs)(n.p,{children:["To drop all indexes, use the ",(0,t.jsx)(n.code,{children:"dropAllIndexes"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.dropAllIndexes();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"listing-indexes",children:"Listing indexes"}),"\n",(0,t.jsxs)(n.p,{children:["To list a collection indexes, use the ",(0,t.jsx)(n.code,{children:"listIndexes"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.listIndexes();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"check-if-index-exists",children:"Check if index exists"}),"\n",(0,t.jsxs)(n.p,{children:["To check if an index exists, use the ",(0,t.jsx)(n.code,{children:"indexExists"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await usersBlueprint.indexExists("name");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"get-indexes-information",children:"Get indexes information"}),"\n",(0,t.jsxs)(n.p,{children:["To get indexes information, use the ",(0,t.jsx)(n.code,{children:"indexInformation"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.indexInformation();\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will return an array of indexes information."}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsxs)(n.p,{children:["Read more about what is being returned from the ",(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/method/db.collection.getIndexes/#output",children:"MongoDB documentation"}),"."]}),(0,t.jsx)(n.h2,{id:"truncate-collection",children:"Truncate collection"}),(0,t.jsxs)(n.p,{children:["To truncate ",(0,t.jsx)(n.code,{children:"(Delete all documents)"})," a collection, use the ",(0,t.jsx)(n.code,{children:"truncate"})," method."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.truncate();\n"})}),(0,t.jsx)(n.h2,{id:"drop-collection",children:"Drop collection"}),(0,t.jsxs)(n.p,{children:["To drop a collection, use the ",(0,t.jsx)(n.code,{children:"drop"})," method."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.drop();\n"})}),(0,t.jsx)(n.h2,{id:"get-collection-stats",children:"Get collection stats"}),(0,t.jsxs)(n.p,{children:["To get collection stats, use the ",(0,t.jsx)(n.code,{children:"stats"})," method."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.stats();\n"})}),(0,t.jsx)(n.p,{children:"This will return an object with the collection stats."}),(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["Read more about what is being returned from the ",(0,t.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/reference/operator/aggregation/collStats/",children:"MongoDB documentation"}),"."]})})]}),"\n",(0,t.jsx)(n.h2,{id:"get-collection-size",children:"Get collection size"}),"\n",(0,t.jsxs)(n.p,{children:["To get the collection size, use the ",(0,t.jsx)(n.code,{children:"size"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.size();\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will return the collection size in bytes."}),"\n",(0,t.jsx)(n.h2,{id:"get-indexes-size",children:"Get Indexes Size"}),"\n",(0,t.jsxs)(n.p,{children:["To get the indexes size, use the ",(0,t.jsx)(n.code,{children:"indexesSize"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.indexesSize();\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will return the indexes size in bytes."}),"\n",(0,t.jsx)(n.h2,{id:"get-total-size",children:"Get total size"}),"\n",(0,t.jsxs)(n.p,{children:["Total size equals the collection size plus the indexes size. To get the total size, use the ",(0,t.jsx)(n.code,{children:"totalSize"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.totalSize();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"get-document-average-size",children:"Get document average size"}),"\n",(0,t.jsxs)(n.p,{children:["To get the document average size, use the ",(0,t.jsx)(n.code,{children:"averageDocumentSize"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.averageDocumentSize();\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"avgDocSize"})," method is an ",(0,t.jsx)(n.strong,{children:"alias"})," for ",(0,t.jsx)(n.code,{children:"averageDocumentSize"})," method."]})}),"\n",(0,t.jsx)(n.h2,{id:"count-documents",children:"Count documents"}),"\n",(0,t.jsxs)(n.p,{children:["To count documents in a collection, use the ",(0,t.jsx)(n.code,{children:"count"})," method."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await usersBlueprint.count();\n"})}),"\n",(0,t.jsxs)(n.h2,{id:"the-blueprint-function",children:["The ",(0,t.jsx)(n.code,{children:"blueprint"})," function"]}),"\n",(0,t.jsxs)(n.p,{children:["If you want to instantiate a blueprint for a collection, you can use the ",(0,t.jsx)(n.code,{children:"blueprint"})," function."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { blueprint } from "@warlock.js/cascade";\r\n\r\nconst usersBlueprint = blueprint("users");\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Which internally creates a new instance of the ",(0,t.jsx)(n.code,{children:"Blueprint"})," class."]})]})}function x(e={}){const{wrapper:n}={...(0,s.RP)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},5680:(e,n,i)=>{i.d(n,{RP:()=>c});var t=i(6540);function s(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function r(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function d(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?r(Object(i),!0).forEach((function(n){s(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function l(e,n){if(null==e)return{};var i,t,s=function(e,n){if(null==e)return{};var i,t,s={},r=Object.keys(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||(s[i]=e[i]);return s}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}var o=t.createContext({}),c=function(e){var n=t.useContext(o),i=n;return e&&(i="function"==typeof e?e(n):d(d({},n),e)),i},a={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},x=t.forwardRef((function(e,n){var i=e.components,s=e.mdxType,r=e.originalType,o=e.parentName,x=l(e,["components","mdxType","originalType","parentName"]),u=c(i),h=s,p=u["".concat(o,".").concat(h)]||u[h]||a[h]||r;return i?t.createElement(p,d(d({ref:n},x),{},{components:i})):t.createElement(p,d({ref:n},x))}));x.displayName="MDXCreateElement"}}]);