"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3763],{533:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var s=r(4848),n=r(8453);const o={sidebar_position:4},i="Custom Validator",a={id:"warlock/validation/custom-validator",title:"Custom Validator",description:"Consider a custom validator as the final middleware interceptor before processing the request, it's used to validate the request after the validation rules.",source:"@site/docs/warlock/validation/custom-validator.mdx",sourceDirName:"warlock/validation",slug:"/warlock/validation/custom-validator",permalink:"/docs/warlock/validation/custom-validator",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"warlock",previous:{title:"Validation Schema",permalink:"/docs/warlock/validation/validation-schema"},next:{title:"Rules",permalink:"/docs/category/rules"}},l={},c=[{value:"How it works",id:"how-it-works",level:2},{value:"Example",id:"example",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"custom-validator",children:"Custom Validator"}),"\n",(0,s.jsx)(t.p,{children:"Consider a custom validator as the final middleware interceptor before processing the request, it's used to validate the request after the validation rules."}),"\n",(0,s.jsx)(t.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,s.jsxs)(t.p,{children:["After running all validation rules, ",(0,s.jsx)(t.code,{children:"Warlock"})," will try to identify the request handler ",(0,s.jsx)(t.code,{children:"validate"})," method, if exists, it will run it, and pass the request and response objects to it."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"validate"})," method acts as a ",(0,s.jsx)(t.a,{href:"./../http/middleware",children:"middleware"}),", it receives the request and response objects, if it returns a response object, then the request will be terminated, and the response will be sent back to the client, otherwise, the request will be processed normally."]}),"\n",(0,s.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,s.jsxs)(t.p,{children:["Let's take an example of the ",(0,s.jsx)(t.code,{children:"login"})," request:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:'title="src/app/users/routes.ts"',children:'import { router } from "@warlock.js/core";\r\nimport { login } from "./controllers/auth/login";\r\n\r\nrouter.post("/login", login);\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"login"})," function is the request handler, and it's located at ",(0,s.jsx)(t.code,{children:"src/app/users/controllers/auth/login.ts"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",metastring:'{9} title="src/app/users/controllers/auth/login.ts"',children:'import { Request, Response } from "@warlock.js/core";\r\nimport { User } from "app/users/models/user";\r\n\r\nexport default async function login(request: Request, response: Response) {\r\n  // do logic here\r\n}\r\n\r\nlogin.validation = {\r\n  validate: async (request: Request, response: Response) => {\r\n    // custom validation here\r\n    const user = await User.attempt(request.only(["email", "password"]));\r\n\r\n    if (!user) {\r\n      return response.unauthorized();\r\n    }\r\n\r\n    // inject the user object to the request object\r\n    // Make sure to not return a value, otherwise the request will be terminated\r\n    request.user = user;\r\n  },\r\n};\n'})})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>a});var s=r(6540);const n={},o=s.createContext(n);function i(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);