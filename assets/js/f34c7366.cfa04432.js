"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6563],{8030:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>t,toc:()=>d});var r=i(4848),s=i(8453);const a={sidebar_position:3},l="Validation Rules",t={id:"warlock/validation/validation-rules",title:"Validation Rules",description:"Validation rules are used to validate the request input, it's used to validate the request body, query, and params.",source:"@site/docs/warlock/validation/validation-rules.mdx",sourceDirName:"warlock/validation",slug:"/warlock/validation/validation-rules",permalink:"/docs/warlock/validation/validation-rules",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"warlock",previous:{title:"Validation Configurations",permalink:"/docs/warlock/validation/configurations"},next:{title:"Validation Schema",permalink:"/docs/warlock/validation/validation-schema"}},o={},d=[{value:"How it works",id:"how-it-works",level:2},{value:"Example",id:"example",level:2},{value:"Defining Validation Rules",id:"defining-validation-rules",level:2},{value:"Using Rule Object",id:"using-rule-object",level:2},{value:"Validation Rules List",id:"validation-rules-list",level:2},{value:"Create Your Own Validation Rule",id:"create-your-own-validation-rule",level:2},{value:"Passing options to validation rules",id:"passing-options-to-validation-rules",level:2},{value:"Validation error messages",id:"validation-error-messages",level:2},{value:"]Default error messages",id:"default-error-messages",level:3},{value:"Translated input names",id:"translated-input-names",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,r.jsx)(n.p,{children:"Validation rules are used to validate the request input, it's used to validate the request body, query, and params."}),"\n",(0,r.jsx)(n.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,r.jsxs)(n.p,{children:["Each handler can have special property called ",(0,r.jsx)(n.code,{children:"validation"}),", this property is an object that has two keys:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rules"}),": An object of validation rules."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"validate"}),": ",(0,r.jsx)(n.a,{href:"./custom-validator",children:"A Custom validator"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.p,{children:"Let's take an example of validating the login request:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="src/app/users/controllers/auth/login.ts"',children:'import { Request, Response } from "@warlock.js/core";\r\nimport { User } from "app/users/models/user";\r\n\r\nexport default async function login(request: Request, response: Response) {\r\n  // do logic here\r\n}\r\n\r\nlogin.validation = {\r\n  rules: {\r\n    email: ["required", "email"],\r\n    password: ["required", "string"],\r\n  },\r\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:["In our previous handler, we added ",(0,r.jsx)(n.code,{children:"login.validation"}),", the validator object with ",(0,r.jsx)(n.code,{children:"rules"})," object."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"rules"})," object has two keys ",(0,r.jsx)(n.strong,{children:"email"})," and ",(0,r.jsx)(n.strong,{children:"password"}),", each key has an array of validation rules."]}),"\n",(0,r.jsx)(n.h2,{id:"defining-validation-rules",children:"Defining Validation Rules"}),"\n",(0,r.jsx)(n.p,{children:"There are two ways to use validation rules, either by passing the validation rule name as a string, or by passing a rule object."}),"\n",(0,r.jsxs)(n.p,{children:["All validation rules has its own name, but it must be defined in the ",(0,r.jsx)(n.a,{href:"./configurations",children:"Validation configurations"}),". under the rules object."]}),"\n",(0,r.jsxs)(n.p,{children:["Each key inside the ",(0,r.jsx)(n.code,{children:"rules"})," object will be used as the rule name indicator, for example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'import {\r\n  EmailRule,\r\n  InRule,\r\n  LengthRule,\r\n  MaxLengthRule,\r\n  MinLengthRule,\r\n  RequiredRule,\r\n  StringRule,\r\n  ValidationConfigurations,\r\n} from "@warlock.js/core";\r\n\r\nconst validationConfigurations: ValidationConfigurations = {\r\n  rules: {\r\n    required: RequiredRule,\r\n    string: StringRule,\r\n    in: InRule,\r\n    minLength: MinLengthRule,\r\n    length: LengthRule,\r\n    maxLength: MaxLengthRule,\r\n    email: EmailRule,\r\n  },\r\n  // ...\r\n};\r\n\r\nexport default validationConfigurations;\n'})}),"\n",(0,r.jsx)(n.p,{children:"In the previous example, we defined the validation rules that we will use in our application."}),"\n",(0,r.jsxs)(n.p,{children:["So to use the Email rule for instance, it is mapped with ",(0,r.jsx)(n.code,{children:"email"})," key, so we can use it as a string:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:"{3}",children:'login.validation = {\r\n  rules: {\r\n    email: ["required", "email"],\r\n    password: ["required", "string"],\r\n  },\r\n};\n'})}),"\n",(0,r.jsx)(n.h2,{id:"using-rule-object",children:"Using Rule Object"}),"\n",(0,r.jsxs)(n.p,{children:["Another way to use the validation rules is by passing the rule object instead of the rule name, mostly this is used with ",(0,r.jsx)(n.a,{href:"./rules/unique",children:"UniqueRule"})," and ",(0,r.jsx)(n.a,{href:"./rules/exists",children:"ExistsRule"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"For example, let's consider the following example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'import { ExistsRule } from "@warlock.js/core";\r\nimport { User } from "app/users/models/user";\r\n\r\nlogin.validation = {\r\n  rules: {\r\n    email: ["required", "email", new ExistsRule(User)],\r\n    password: ["required", "string"],\r\n  },\r\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:["In the previous example, we used the ",(0,r.jsx)(n.code,{children:"ExistsRule"})," with the ",(0,r.jsx)(n.code,{children:"User"})," model, so the rule will check if the user exists in the database or not."]}),"\n",(0,r.jsx)(n.h2,{id:"validation-rules-list",children:"Validation Rules List"}),"\n",(0,r.jsxs)(n.p,{children:["By default, ",(0,r.jsx)(n.code,{children:"Warlock"})," is shipped with ",(0,r.jsx)(n.code,{children:"+30"})," validation rules."]}),"\n",(0,r.jsxs)(n.p,{children:["To see the full list of validation rules, please head to ",(0,r.jsx)(n.a,{href:"./rules/rules-list",children:"Validation Rules List"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"create-your-own-validation-rule",children:"Create Your Own Validation Rule"}),"\n",(0,r.jsxs)(n.p,{children:["You can create your own validation rule, please head to ",(0,r.jsx)(n.a,{href:"./rules/create-your-own-rule",children:"Create Your Own Validation Rule"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"passing-options-to-validation-rules",children:"Passing options to validation rules"}),"\n",(0,r.jsxs)(n.p,{children:["Any validation rule can receive options (if the rule requires that) by adding ",(0,r.jsx)(n.code,{children:":"})," after the rule name, and passing the options as a string."]}),"\n",(0,r.jsxs)(n.p,{children:["For example, ",(0,r.jsx)(n.code,{children:"minLength"})," requires a value to be passed, so we can pass it like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'login.validation = {\r\n  rules: {\r\n    email: ["required", "email"],\r\n    password: ["required", "string", "minLength:8"],\r\n  },\r\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:["To set the options using Rule object,pass an array of options to ",(0,r.jsx)(n.code,{children:"setOptions"})," method."]}),"\n",(0,r.jsx)(n.p,{children:"For example, let's consider the following example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'import { MinLengthRule } from "@warlock.js/core";\r\n\r\nlogin.validation = {\r\n  rules: {\r\n    email: ["required", "email"],\r\n    password: ["required", "string", new MinLengthRule().setOptions([8])],\r\n  },\r\n};\n'})}),"\n",(0,r.jsx)(n.h2,{id:"validation-error-messages",children:"Validation error messages"}),"\n",(0,r.jsxs)(n.p,{children:["All validation rules are stored under ",(0,r.jsx)(n.code,{children:"validation"})," group name, by default it supports ",(0,r.jsx)(n.code,{children:"English"})," and ",(0,r.jsx)(n.code,{children:"Arabic"})," languages, you can however add your own language."]}),"\n",(0,r.jsx)(n.h3,{id:"default-error-messages",children:"]Default error messages"}),"\n",(0,r.jsxs)(n.p,{children:["To override an error message from the default messages, you can use the ",(0,r.jsx)(n.code,{children:"groupedTranslations"})," function, for example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="src/app/general/utils/locales.ts"',children:'import { groupedTranslation } from "@mongez/localization";\r\n\r\ngroupedTranslation("validation", {\r\n  required: {\r\n    en: ":input is mandatory",\r\n    ar: "\u064a\u062c\u0628 \u0627\u0646 \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0642\u064a\u0645\u0629 :input",\r\n  },\r\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"translated-input-names",children:"Translated input names"}),"\n",(0,r.jsxs)(n.p,{children:["Let's say our current app locale code is ",(0,r.jsx)(n.code,{children:"ar"})," which is Arabic, now we want to return an error for ",(0,r.jsx)(n.code,{children:"firstName"})," that indicates it is required which is defined in the validation as follows:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'groupedTranslation("validation", {\r\n  required: {\r\n    en: ":input is required",\r\n    ar: "\u0645\u0637\u0644\u0648\u0628 :input",\r\n  },\r\n});\n'})})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>t});var r=i(6540);const s={},a=r.createContext(s);function l(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);